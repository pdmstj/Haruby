<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì˜¤ëŠ˜ì˜ ìš´ì„¸ ì¶”ì²œ</title>
  <link rel="stylesheet" href="style.css">
</head>
<body id="main-body">
  <h1 id="greeting">âœ¨ Haruby âœ¨</h1>
  <div class="chatbot-container">
    <button onclick="getFortune()">ì „ì²´ ì¶”ì²œ ë³´ê¸°</button>

    <select id="categorySelect" onchange="getCategory()">
      <option value="">ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>
      <option value="foods">ìŒì‹</option>
      <option value="musics">ìŒì•…</option>
      <option value="games">ê²Œì„</option>
    </select>

    <div id="result" class="chat-box"></div>
  </div>

  <script>
    function getFortune() {
      document.getElementById('result').innerHTML = "<div class='bubble'>ğŸ”® ìš´ì„¸ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘...</div>";
      fetch('/today-luck')
        .then(res => res.json())
        .then(data => {
          if (data.error) return alert(data.error);
          document.getElementById('result').innerHTML = `
            <div class="bubble"><strong>ğŸŒŸ ìš´ì„¸</strong><br>${data.ìš´ì„¸}</div>
            <div class="bubble"><strong>ğŸœ ìŒì‹</strong><br>${data.ìŒì‹}</div>
            <div class="bubble"><strong>ğŸµ ìŒì•…</strong><br>${data.ìŒì•…}</div>
            <div class="bubble"><strong>ğŸ® ê²Œì„</strong><br>${data.ê²Œì„}</div>
          `;
        });
    }

    function getCategory() {
      const category = document.getElementById('categorySelect').value;
      if (!category) return;
      fetch(`/today-luck/${category}`)
        .then(res => res.json())
        .then(data => {
          if (data.error) return alert(data.error);
          document.getElementById('result').innerHTML = `
            <div class="bubble"><strong>ğŸ ì¶”ì²œ ${category}</strong><br>${data[category]}</div>
          `;
        });
    }

    // ì‹œê°„ëŒ€ë³„ ì¸ì‚¬ë§ ë° ë°°ê²½ ì„¤ì •
    const now = new Date();
    const hour = now.getHours();
    const body = document.getElementById('main-body');
    const greeting = document.getElementById('greeting');

    if (hour >= 5 && hour < 12) {
      body.classList.add('morning');
      greeting.innerText = 'â˜€ï¸ ì¢‹ì€ ì•„ì¹¨ì´ì—ìš”!';
    } else if (hour >= 12 && hour < 17) {
      body.classList.add('afternoon');
      greeting.innerText = 'ğŸŒ¤ ì¢‹ì€ ì˜¤í›„ì—ìš”!';
    } else if (hour >= 17 && hour < 21) {
      body.classList.add('evening');
      greeting.innerText = 'ğŸŒ‡ ì¢‹ì€ ì €ë…ì´ì—ìš”!';
    } else {
      body.classList.add('night');
      greeting.innerText = 'ğŸŒ™ í¸ì•ˆí•œ ë°¤ ë˜ì„¸ìš”!';
    }
  </script>
</body>
</html>
